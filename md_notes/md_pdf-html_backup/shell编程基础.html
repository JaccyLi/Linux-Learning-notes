<!DOCTYPE html>
<html>
<head>
<title>shell编程基础.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
	font-size: 14px;
	padding: 0 12px;
	line-height: 22px;
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}


body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	color: #4080D0;
	text-decoration: none;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

h1 code,
h2 code,
h3 code,
h4 code,
h5 code,
h6 code {
	font-size: inherit;
	line-height: auto;
}

a:hover {
	color: #4080D0;
	text-decoration: underline;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left: 5px solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 14px;
	line-height: 19px;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

.mac code {
	font-size: 12px;
	line-height: 18px;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

/** Theming */

.vscode-light,
.vscode-light pre code {
	color: rgb(30, 30, 30);
}

.vscode-dark,
.vscode-dark pre code {
	color: #DDD;
}

.vscode-high-contrast,
.vscode-high-contrast pre code {
	color: white;
}

.vscode-light code {
	color: #A31515;
}

.vscode-dark code {
	color: #D7BA7D;
}

.vscode-light pre:not(.hljs),
.vscode-light code > div {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre:not(.hljs),
.vscode-dark code > div {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre:not(.hljs),
.vscode-high-contrast code > div {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

.vscode-light blockquote,
.vscode-dark blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.vscode-high-contrast blockquote {
	background: transparent;
	border-color: #fff;
}
</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family:  "Meiryo", "Segoe WPC", "Segoe UI", "SFUIText-Light", "HelveticaNeue-Light", sans-serif, "Droid Sans Fallback";
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

</head>
<body>
<center><font size=214 face=黑体 color=grey>HELL脚本编程基础</font></center>
<h1 id="%E4%B8%80%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80">一.编程基础</h1>
<h2 id="1%E7%A8%8B%E5%BA%8F%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5">1.程序基本概念</h2>
<ul>
<li>Linux内核的编写者Linus Tovarls曾经说过：Talk is cheap, show me the code.(用代码说话);所以学shell编程的唯一办法就是写shell程序，不断的写写写。</li>
<li>shell 编程基础主要涉及变量、基本算术运算、条件测试和条件判断等编程基础知识。在正式学习shell编程之前先了解一些程序相关的基本概念。</li>
</ul>
<pre class="hljs"><code><div>程序的概念：
程序：程序本质上是一系列的数据结构加上处理这些数据的算法形成的，程序的核心就是数据结构。
算法：使用程序描述的处理数据的方式
数据结构：数据在计算机中的类型和组织方式(数据在内存中的存储和组织方式)

编写程序时有多种程序编程风格：

过程式：以指令为中心，数据服务于指令  
对象式：以数据为中心，指令服务于数据
</div></code></pre>
<h2 id="2%E4%B8%8D%E5%90%8C%E7%9A%84%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8F">2.不同的程序的执行方式</h2>
<ul>
<li>计算机只能识别二进制指令；</li>
<li>低级编程语言：</li>
</ul>
<pre class="hljs"><code><div>机器语言：由二进制的<span class="hljs-number">0</span>和<span class="hljs-number">1</span>的序列组成，称为机器指令;与自然语言差异太大，难懂、难写
汇编语言：用一些助记符号替代机器指令，称为汇编语言 
        如：ADD A,B 将寄存器A的数与寄存器B的数相加得到的数放到寄存器A中 
汇编语言写好的程序需要汇编程序转换成机器指令
汇编语言稍微好理解，即机器指令对应的助记符，助记符更接近自然语言 
</div></code></pre>
<ul>
<li>高级编程语言</li>
</ul>
<pre class="hljs"><code><div>高级语言又有解释型和编译型语言；
编译型语言：高级语言--&gt;编译器--&gt;机器代码--&gt;执行 
         如：C，C++ 
解释语言：高级语言--&gt;执行--&gt;解释器--&gt;机器代码 
         如： shell,python,php,JavaScript,perl,Ruby 
</div></code></pre>
<h2 id="3%E7%BC%96%E8%AF%91%E5%9E%8B%E8%AF%AD%E8%A8%80%E5%92%8C%E8%A7%A3%E9%87%8A%E5%9E%8B%E8%AF%AD%E8%A8%80">3.编译型语言和解释型语言</h2>
<ul>
<li>编译型语言将源码编译为二进制可执行文件后由计算机运行，运行时无需源码</li>
<li>解释型语言是在程序运行时一条一条的将代码解释为计算机可识别的指令，运行时需要源码</li>
<li>对比</li>
</ul>
<table>
<thead>
<tr>
<th>编译型语言</th>
<th>解释型语言</th>
</tr>
</thead>
<tbody>
<tr>
<td>c,c++,Delphi,Rust</td>
<td>shell,python,php,JavaScript,perl,Ruby</td>
</tr>
<tr>
<td>一次性将源码编译为机器指令</td>
<td>在程序执行时才一条一条的将源代码转换为机器指令</td>
</tr>
<tr>
<td>高性能，运行速度快</td>
<td>支持夸平台，运行速度慢</td>
</tr>
<tr>
<td>在语言编译阶段可以做充分的优化</td>
<td>不需要编译阶段，直接执行代码</td>
</tr>
</tbody>
</table>
<p><img src="png/different_language.png" alt=""></p>
<h1 id="%E4%BA%8Cshell%E8%84%9A%E6%9C%AC%E5%9F%BA%E7%A1%80">二.shell脚本基础</h1>
<h2 id="1shell%E8%84%9A%E6%9C%AC%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%BB%93%E6%9E%84">1.shell脚本的基本结构</h2>
<ul>
<li>脚本的基本结构</li>
</ul>
<pre class="hljs"><code><div>SHEBANG                       <span class="hljs-comment"># SHEBANG机制，指明解释该脚本的shell程序</span>
CONFIGURATION_VARIABLES         <span class="hljs-comment"># 在写明解释器后，接着的行一般用来声明一些变量</span>
FUNCTION_DEFINITIONS            <span class="hljs-comment"># 接着定义函</span>
MAIN_CODE                       <span class="hljs-comment"># 接着是脚本内容</span>
</div></code></pre>
<h2 id="2hell%E8%84%9A%E6%9C%AC%E6%A0%BC%E5%BC%8F%E8%A6%81%E6%B1%82%EF%BC%9A%E9%A6%96%E8%A1%8Cshebang%E6%9C%BA%E5%88%B6">2.hell脚本格式要求：首行shebang机制</h2>
<pre class="hljs"><code><div><span class="hljs-meta">#!/bin/bash </span>
<span class="hljs-comment">#!/usr/bin/python </span>
<span class="hljs-comment">#!/usr/bin/perl </span>
</div></code></pre>
<ul>
<li>shell脚本的用途有：</li>
</ul>
<pre class="hljs"><code><div>自动化常用命令 
执行系统管理和故障排除 
创建简单的应用程序 
处理文本或文件
</div></code></pre>
<ul>
<li>创建shell脚本</li>
</ul>
<pre class="hljs"><code><div>第一步：使用文本编辑器来创建文本文件 
      第一行必须包括shell声明序列：<span class="hljs-comment">#! </span>
      示例：<span class="hljs-comment">#!/bin/bash  </span>
      添加注释 
          注释以<span class="hljs-comment">#开头 </span>
第二步：运行脚本 
      给予执行权限，在命令行上指定脚本的绝对或相对路径 
      直接运行解释器，将脚本作为解释器程序的参数运行 
</div></code></pre>
<ul>
<li>脚本代码开头约定</li>
</ul>
<pre class="hljs"><code><div>1、第一行一般为调用使用的语言 
2、程序名，避免更改文件名为无法找到正确的文件 
3、版本号 
4、更改后的时间 
5、作者相关信息 
6、该程序的作用，及注意事项 
7、最后是各版本的更新简要说明 
</div></code></pre>
<ul>
<li>shell脚本示例</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-meta">#!/bin/bash</span>
<span class="hljs-comment"># ------------------------------------------ </span>
<span class="hljs-comment"># Filename:             hello.sh </span>
<span class="hljs-comment"># Revision:             0.99 </span>
<span class="hljs-comment"># Date:                 2019/09/18 </span>
<span class="hljs-comment"># Author:               steve </span>
<span class="hljs-comment"># Email:                steve@gmail.com </span>
<span class="hljs-comment"># Website:              suosuoli.cn</span>
<span class="hljs-comment"># Description:          This is my first script.</span>
<span class="hljs-comment"># Copyright:            2019 steve </span>
<span class="hljs-comment"># License:              GPL </span>
<span class="hljs-comment"># ------------------------------------------ </span>
 <span class="hljs-built_in">echo</span> -e “Hello world! I<span class="hljs-string">'m a programmer now! Wow!”
</span></div></code></pre>
<h2 id="3%E8%84%9A%E6%9C%AC%E8%B0%83%E8%AF%95">3.脚本调试</h2>
<pre class="hljs"><code><div>检测脚本中的语法错误 
bash -n /path/to/some_script 
调试执行 
bash -x /path/to/some_script 
</div></code></pre>
<h1 id="%E4%B8%89%E5%8F%98%E9%87%8F">三.变量</h1>
<h2 id="1bash%E4%B8%AD%E5%8F%98%E9%87%8F%E7%9A%84%E7%A7%8D%E7%B1%BB">1.bash中变量的种类</h2>
<ul>
<li>在shell中根据变量的生效范围等标准划分下面变量类型</li>
</ul>
<pre class="hljs"><code><div>局部变量：生效范围为当前shell进程；对当前shell之外的其它shell进程，包括当前shell的子shell进程均无效 
 
环境变量：生效范围为当前shell进程及其子进程 
 
本地变量：生效范围为当前shell进程中某代码片断，通常指函数 
 
位置变量：<span class="hljs-variable">$1</span>, <span class="hljs-variable">$2</span>, ...来表示，用于让脚本在脚本代码中调用通过命令行传递给它的参数 
 
特殊变量：$?, <span class="hljs-variable">$0</span>, $*, <span class="hljs-variable">$@</span>, <span class="hljs-variable">$#</span>,$$ 
    $? 存储脚本、命令或者函数的退出状态值；脚本的退出状态为脚本中最后一条命令的退出状态;函数退出状态也为最后一条命令的退出状态;一般成功执行退出状态为0；命令执行失败退出状态为1-255之间的整数.
    <span class="hljs-variable">$0</span> 执行脚本时脚本的路径名 
    $* 将所有位置参数视为单个字符串
    <span class="hljs-variable">$@</span> 每个位置参数存储为单独引用的字符串，分开对待每个位置参数
    <span class="hljs-variable">$#</span> 脚本后所跟的参数的个数
    $$ 为PID变量，存储其出现在的脚本所属的进程的进程号
```bash
[root@centos7 ~]$ pstree -p |grep sshd.*bash
|-sshd(1164)---sshd(1842)---bash(1848)---bash(6007)-+-grep(6043)
[root@centos7 ~]$ <span class="hljs-built_in">echo</span> $$                        <span class="hljs-comment"># 当前所在bash进程为6007</span>
6007
[root@centos7 ~]<span class="hljs-variable">$exit</span>                           <span class="hljs-comment"># 退出6007号bash进程</span>
<span class="hljs-built_in">exit</span>
[root@centos7 ~]<span class="hljs-variable">$echo</span> $$                        <span class="hljs-comment"># 此时$$记录1848</span>
1848
</div></code></pre>
<ul>
<li>局部变量赋值和引用</li>
</ul>
<pre class="hljs"><code><div>变量赋值：name=<span class="hljs-string">'value'</span> 
(1) 可以是直接字串：name=<span class="hljs-string">'root'</span> 
(2) 变量引用：name=<span class="hljs-string">"<span class="hljs-variable">$USER</span>"</span> 
(3) 命令引用：name=`COMMAND`   
             name=$(COMMAND) 
变量引用：<span class="hljs-variable">${name}</span>  或者  <span class="hljs-variable">$name</span> 
</div></code></pre>
<ul>
<li>
<p>显示已定义的所有变量使用set命令</p>
</li>
<li>
<p>删除变量：unset name</p>
</li>
</ul>
<h2 id="2%E7%BB%83%E4%B9%A0">2.练习</h2>
<ul>
<li>1、编写脚本 systeminfo.sh，显示当前主机系统信息，包括主机名，IPv4地址，操作系统版本，内核版本，CPU型号，内存大小，硬盘大小</li>
</ul>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                    steveli</span>
 <span class="hljs-comment">#QQ:                        1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-06</span>
 <span class="hljs-comment">#FileName:                  systemInfoForCentos678.sh</span>
 <span class="hljs-comment">#URL:                       https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:               Show some sys info.</span>
 <span class="hljs-comment">#Copyright (C):             2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>

R_SEED=$(( <span class="hljs-variable">$RANDOM</span>%7+31 )) 
COLOR_START=<span class="hljs-string">"\e[1;<span class="hljs-variable">${R_SEED}</span>m"</span>
COLOR_END=<span class="hljs-string">"\e[0m"</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"The hostname is:              <span class="hljs-variable">${COLOR_START}</span>`hostname`. <span class="hljs-variable">${COLOR_END}</span>"</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"IPV4 addr is:                 <span class="hljs-variable">${COLOR_START}</span>`ifconfig | egrep -o '([0-9]{1,3}\.){3}[0-9]{,3}' |head -n1` <span class="hljs-variable">${COLOR_END}</span>"</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"The OS version is:            <span class="hljs-variable">${COLOR_START}</span>`cat /etc/redhat-release | egrep -o '[0-9]+\.[0-9]+(\.[0-9]+)?'` <span class="hljs-variable">${COLOR_END}</span>"</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"The kernel version is:        <span class="hljs-variable">${COLOR_START}</span>` uname -r `. <span class="hljs-variable">${COLOR_END}</span>"</span>
free -h |grep <span class="hljs-string">"Mem"</span> | tr -s <span class="hljs-string">" "</span> |cut -d<span class="hljs-string">" "</span>  -f2,4 &gt; /tmp/total_free 
TOTAL=`cat /tmp/total_free | cut -d<span class="hljs-string">" "</span>  -f1`
FREE=`cat /tmp/total_free | cut -d<span class="hljs-string">" "</span>  -f2`
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"The total online memory is:   <span class="hljs-variable">${COLOR_START}</span><span class="hljs-variable">$TOTAL</span>(<span class="hljs-variable">${FREE}</span> free)<span class="hljs-variable">${COLOR_END}</span>"</span>
<span class="hljs-built_in">echo</span> -e  <span class="hljs-string">"\nHarddisk usage:             <span class="hljs-variable">${COLOR_START}</span> \n\n`df -h | egrep -e /dev/sd -e /dev/nvme` <span class="hljs-variable">${COLOR_END}</span>"</span>
<span class="hljs-built_in">unset</span> R_SEED COLOR_START COLOR_END
<span class="hljs-built_in">unset</span> TOTAL FREE
</div></code></pre>
<p>2、编写脚本 backup.sh，可实现每日将/etc/目录备份到/backup/etcYYYY-
mm-dd中</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:            steveli</span>
 <span class="hljs-comment">#QQ:                1049103823</span>
 <span class="hljs-comment">#Data:              2019-10-07</span>
 <span class="hljs-comment">#FileName:          backup.sh</span>
 <span class="hljs-comment">#URL:               https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:       Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
DIR=<span class="hljs-string">"/data/backup/"</span>
<span class="hljs-built_in">echo</span> <span class="hljs-string">"Backup starting ..."</span>
sleep 1
cp -av /etc/ <span class="hljs-variable">${DIR}</span>etc`date +%F`
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\e[1;32mBackup finished."</span>
<span class="hljs-built_in">echo</span> -e <span class="hljs-string">"The backup file located at : <span class="hljs-variable">${DIR}</span> \a\e[0m"</span>
</div></code></pre>
<p>3、编写脚本 disk.sh，显示当前硬盘分区中空间利用率最大的值</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:            steveli</span>
 <span class="hljs-comment">#QQ:                1049103823</span>
 <span class="hljs-comment">#Data:              2019-10-07</span>
 <span class="hljs-comment">#FileName:          disk.sh</span>
 <span class="hljs-comment">#URL:               https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:       Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 MAX=`df -h | grep -E /dev/\(sd\|nvme\) | egrep -o <span class="hljs-string">"[0-9]{,3}%"</span> | cut -d% -f1 | sort -nr | head -n1`
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"The max usage of space is <span class="hljs-variable">$MAX</span>(%)."</span>
</div></code></pre>
<p>4、编写脚本 links.sh，显示正连接本主机的每个远程主机的IPv4地址和连接数，并按连接数从大到小排序</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:            steveli</span>
 <span class="hljs-comment">#QQ:                1049103823</span>
 <span class="hljs-comment">#Data:              2019-10-07</span>
 <span class="hljs-comment">#FileName:          backup.sh</span>
 <span class="hljs-comment">#URL:               https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:       Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
<span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$#</span> -gt 0 ]]; <span class="hljs-keyword">then</span>
    FILE=<span class="hljs-variable">$1</span>
    cat <span class="hljs-variable">${FILE}</span> |grep ESTAB | tr -s <span class="hljs-string">" "</span> | cut -d<span class="hljs-string">" "</span> -f5 | cut -d: -f1 | sort | uniq -c | sort -nr 
<span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$#</span> -eq 0 ]]; <span class="hljs-keyword">then</span>
    ss -tun |grep ESTAB | tr -s <span class="hljs-string">" "</span> | cut -d<span class="hljs-string">" "</span> -f6 | cut -d: -f1 | sort | uniq -c | sort -nr 
<span class="hljs-keyword">fi</span>
</div></code></pre>
<h2 id="3%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">3.环境变量</h2>
<ul>
<li>环境变量的声明、赋值</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-built_in">export</span> name=VALUE 
<span class="hljs-built_in">declare</span> -x name=VALUE 
</div></code></pre>
<ul>
<li>变量引用</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-variable">$name</span>, <span class="hljs-variable">${name}</span> 
</div></code></pre>
<ul>
<li>显示所有环境变量</li>
</ul>
<pre class="hljs"><code><div>env 
printenv 
<span class="hljs-built_in">export</span> 
<span class="hljs-built_in">declare</span> -x 
</div></code></pre>
<ul>
<li>删除变量</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-built_in">unset</span> name 
</div></code></pre>
<h2 id="4bash%E5%86%85%E5%BB%BA%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F">4.bash内建的环境变量</h2>
<pre class="hljs"><code><div>PATH 
SHELL 
USER 
UID 
HOME 
PWD 
SHLVL 
LANG 
MAIL 
HOSTNAME 
HISTSIZE 
_ :下划线 
</div></code></pre>
<h2 id="5%E5%8F%AA%E8%AF%BB%E5%92%8C%E4%BD%8D%E7%BD%AE%E5%8F%98%E9%87%8F">5.只读和位置变量</h2>
<ul>
<li>
<p>只读变量：只能声明，但不能修改和删除</p>
</li>
<li>
<p>声明只读变量：</p>
</li>
<li>
<ul>
<li>readonly name</li>
</ul>
</li>
<li>
<ul>
<li>declare   -r name</li>
</ul>
</li>
<li>
<p>查看只读变量：</p>
</li>
<li>
<ul>
<li>readonly  -p</li>
</ul>
</li>
<li>
<p>位置变量：在脚本代码中调用通过命令行传递给脚本的参数</p>
</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-variable">$1</span>, <span class="hljs-variable">$2</span>, ... 
对应第1、第2等参数，<span class="hljs-built_in">shift</span> [n]换位置 
<span class="hljs-variable">$0</span>
    命令本身 
$*
    传递给脚本的所有参数，全部参数合为一个字符串 
<span class="hljs-variable">$@</span>
    传递给脚本的所有参数，每个参数为独立字符串 
<span class="hljs-variable">$#</span>
    传递给脚本的参数的个数 
注意：<span class="hljs-variable">$@</span> $* 只在被双引号包起来的时候才会有差异  
<span class="hljs-built_in">set</span> --  清空所有位置变量 
</div></code></pre>
<ul>
<li>在linux中，进程使用退出状态来报告成功或失败;存储退出状态的环境变量使用$?；$?存储的值范围为0-255。</li>
</ul>
<pre class="hljs"><code><div>0  代表成功
1－255代表失败 
示例： 
    ping -c1 -W1 hostdown &amp;&gt; /dev/null  
    <span class="hljs-built_in">echo</span> $? 
</div></code></pre>
<ul>
<li>bash允许自定义退出状态码</li>
</ul>
<pre class="hljs"><code><div>bash自定义退出状态码 
    <span class="hljs-built_in">exit</span> [n]：自定义退出状态码 
    注意：脚本中一旦遇到<span class="hljs-built_in">exit</span>命令，脚本会立即终止；终止退出状态取决于<span class="hljs-built_in">exit</span>命
令后面的数字 
    注意：如果未给脚本指定退出状态码，整个脚本的退出状态码取决于脚本中执
行的最后一条命令的状态码 
</div></code></pre>
<h1 id="%E5%9B%9Bbash-shell%E8%84%9A%E6%9C%AC%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97">四.bash-shell脚本的基本算术运算</h1>
<ul>
<li>bash中的算术运算使用let命令</li>
</ul>
<pre class="hljs"><code><div>基本的运算符包括：
+, -, *, /, %取模（取余）, **（乘方），乘法符号有些场景中需要转义 
</div></code></pre>
<ul>
<li>实现算术运算</li>
</ul>
<pre class="hljs"><code><div>(1) <span class="hljs-built_in">let</span> var=算术表达式 
(2) var=$[算术表达式] 
(3) var=$((算术表达式)) 
(4) var=$(expr arg1 arg2 arg3 ...) 
(5) <span class="hljs-built_in">declare</span> –i var = 数值 
(6) <span class="hljs-built_in">echo</span> ‘算术表达式’ | bc  
</div></code></pre>
<ul>
<li>bash有内建的随机数生成器变量：$RANDOM（0-32767）</li>
</ul>
<pre class="hljs"><code><div>示例：生成 0 - 49 之间随机数 
<span class="hljs-built_in">echo</span> $[<span class="hljs-variable">$RANDOM</span>%50] 
</div></code></pre>
<ul>
<li>bash也支持增强型赋值</li>
</ul>
<pre class="hljs"><code><div>增强型赋值:
+=, -=, *=, /=, %= 

<span class="hljs-built_in">let</span> varOPERvalue 
例如:<span class="hljs-built_in">let</span> count+=3 
     自加3后自赋值 

自增，自减： 
<span class="hljs-built_in">let</span> var+=1 
<span class="hljs-built_in">let</span> var++ 
<span class="hljs-built_in">let</span> var-=1 
<span class="hljs-built_in">let</span> var-- 
</div></code></pre>
<ul>
<li>练习
1、编写脚本 sumid.sh，计算/etc/passwd文件中的第10个用户和第20用户的UID之和</li>
</ul>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-06</span>
 <span class="hljs-comment">#FileName:                  sumid.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>

id1=`cat /etc/passwd | head -n10 | tail -n1 | cut -d: -f3`
id2=`cat /etc/passwd | head -n20 | tail -n1 | cut -d: -f3`
<span class="hljs-built_in">let</span> sum=<span class="hljs-variable">$id1</span>+<span class="hljs-variable">$id2</span>
<span class="hljs-built_in">echo</span> <span class="hljs-variable">$sum</span>

<span class="hljs-built_in">unset</span> <span class="hljs-variable">$id1</span>
<span class="hljs-built_in">unset</span> <span class="hljs-variable">$id2</span>
<span class="hljs-built_in">unset</span> <span class="hljs-variable">$sum</span>
</div></code></pre>
<p>2、编写脚本 sumspace.sh，传递两个文件路径作为参数给脚本，计算这两个文件中所有空白行之和</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-06</span>
 <span class="hljs-comment">#FileName:                  sumspace.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 
 <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$#</span> -eq 2 ]]; <span class="hljs-keyword">then</span>
     F1=`cat <span class="hljs-variable">$1</span> | grep <span class="hljs-string">"^$"</span> | wc -l`
     F2=`cat <span class="hljs-variable">$2</span> | grep <span class="hljs-string">"^$"</span> | wc -l`
     <span class="hljs-built_in">echo</span> $(( <span class="hljs-variable">$F1</span> + <span class="hljs-variable">$F2</span> ))
 <span class="hljs-keyword">else</span>
 <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"Please specify two files.\nUsage: `basename <span class="hljs-variable">$0</span>` file1 file2"</span>
 <span class="hljs-keyword">fi</span>
</div></code></pre>
<p>3、编写脚本 sumfile.sh，统计/etc, /var, /usr 目录中共有多少个一级子目录和文件</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-09</span>
 <span class="hljs-comment">#FileName:                  sumfile.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 
 DIR=`find -L /var/ /etc/ /usr/ -maxdepth 1 -<span class="hljs-built_in">type</span> d | wc -l`
 FILE=`find -L /var/ /etc/ /usr/ -maxdepth 1 -<span class="hljs-built_in">type</span> f | wc -l`
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"The total is : <span class="hljs-variable">$(( $DIR+$FILE-3 )</span>)"</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"The dirnum is : <span class="hljs-variable">$(( $DIR-3 )</span>)"</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"The filenum is : <span class="hljs-variable">$(( $FILE )</span>)"</span>
 <span class="hljs-built_in">unset</span> <span class="hljs-variable">$DIR</span>
 <span class="hljs-built_in">unset</span> <span class="hljs-variable">$FILE</span>
</div></code></pre>
<h1 id="%E4%BA%94bash%E4%B8%AD%E7%9A%84%E5%90%84%E7%A7%8D%E6%B5%8B%E8%AF%95">五.bash中的各种测试</h1>
<h2 id="1%E6%9D%A1%E4%BB%B6%E6%B5%8B%E8%AF%95">1.条件测试</h2>
<pre class="hljs"><code><div>- 判断某需求是否满足，需要由测试机制来实现 
    专用的测试表达式需要由测试命令辅助完成测试过程 
- 评估布尔声明，以便用在条件性执行中 
    •若真，则返回0 
    •若假，则返回1 
测试命令： 
    •<span class="hljs-built_in">test</span> EXPRESSION 
    •[ EXPRESSION ] 
    •[[ EXPRESSION ]] 
注意：EXPRESSION前后必须有空白字符 
</div></code></pre>
<h2 id="2bash%E7%9A%84%E6%95%B0%E5%80%BC%E6%B5%8B%E8%AF%95">2.bash的数值测试</h2>
<pre class="hljs"><code><div>-v VAR 
    测试变量VAR是否设置 
    示例：判断 NAME 变量是否定义 
        [ -v NAME ]  
</div></code></pre>
<ul>
<li>数值测试</li>
</ul>
<pre class="hljs"><code><div>-gt 是否大于 
-ge 是否大于等于 
-eq 是否等于 
-ne 是否不等于
-lt 是否小于 
-le 是否小于等于 
</div></code></pre>
<h2 id="3bash%E7%9A%84%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%B5%8B%E8%AF%95">3.bash的字符串测试</h2>
<pre class="hljs"><code><div>-z <span class="hljs-string">"STRING"</span> 字符串是否为空，空为真，不空为假 
-n <span class="hljs-string">"STRING"</span> 字符串是否不空，不空为真，空为假 
=  是否等于 
&gt;  ascii码是否大于ascii码 
&lt;  是否小于 
!= 是否不等于 
== 左侧字符串是否和右侧的PATTERN相同 
=~ 左侧字符串是否能够被右侧的PATTERN所匹配 
    注意:此表达式用于[[  ]]中，PATTERN为通配符 

</div></code></pre>
<h2 id="4bash%E7%9A%84%E6%96%87%E4%BB%B6%E6%B5%8B%E8%AF%95">4.Bash的文件测试</h2>
<pre class="hljs"><code><div>存在性测试  
    -a FILE：同 -e 
    -e FILE: 文件存在性测试，存在为真，否则为假 
存在性及类别测试 
    -b FILE：是否存在且为块设备文件 
    -c FILE：是否存在且为字符设备文件 
    -d FILE：是否存在且为目录文件 
    -f FILE：是否存在且为普通文件 
    -h FILE 或 -L FILE：存在且为符号链接文件 
    -p FILE：是否存在且为命名管道文件 
    -S FILE：是否存在且为套接字文件
</div></code></pre>
<h2 id="5bash%E7%9A%84%E6%96%87%E4%BB%B6%E6%9D%83%E9%99%90%E6%B5%8B%E8%AF%95">5.Bash的文件权限测试</h2>
<pre class="hljs"><code><div>文件权限测试： 
    -r FILE：是否存在且可读 
    -w FILE: 是否存在且可写 
    -x FILE: 是否存在且可执行 
文件特殊权限测试： 
    -u FILE：是否存在且拥有suid权限 
    -g FILE：是否存在且拥有sgid权限 
    -k FILE：是否存在且拥有sticky权限 
</div></code></pre>
<h2 id="6bash%E7%9A%84%E6%96%87%E4%BB%B6%E5%B1%9E%E6%80%A7%E6%B5%8B%E8%AF%95">6.Bash的文件属性测试</h2>
<pre class="hljs"><code><div>文件大小测试： 
    -s FILE: 是否存在且非空 
文件是否打开：
    -t fd: fd  文件描述符是否在某终端已经打开 
    -N FILE：文件自从上一次被读取之后是否被修改过 
    -O FILE：当前有效用户是否为文件属主 
    -G FILE：当前有效用户是否为文件属组 
</div></code></pre>
<h2 id="7%E5%8F%8C%E7%9B%AE%E6%B5%8B%E8%AF%95%EF%BC%9A">7.双目测试：</h2>
<pre class="hljs"><code><div>FILE1 -ef FILE2: FILE1是否是FILE2的硬链接 
FILE1 -nt FILE2: FILE1是否新于FILE2（mtime） 
FILE1 -ot FILE2: FILE1是否旧于FILE2 
</div></code></pre>
<h2 id="8bash%E7%9A%84%E7%BB%84%E5%90%88%E6%B5%8B%E8%AF%95%E6%9D%A1%E4%BB%B6">8.Bash的组合测试条件</h2>
<pre class="hljs"><code><div>第一种方式： 
    [ EXPRESSION1 -a EXPRESSION2 ] 并且 
    [ EXPRESSION1 -o EXPRESSION2 ] 或者 
    [ ! EXPRESSION ]
取反 
   -a 和 -o 需要使用测试命令进行，[[ ]] 不支持 
第二种方式： 
    COMMAND1 &amp;&amp; COMMAND2  并且，短路与，代表条件性的AND  THEN 
    COMMAND1 || COMMAND2  或者，短路或，代表条件性的OR  ELSE 
! COMMAND   非 
示例： 
 [ -f “<span class="hljs-variable">$FILE</span>” ] &amp;&amp; [[  “<span class="hljs-variable">$FILE</span>”=~ .*\.sh$  ]] 
示例：
  <span class="hljs-built_in">test</span>  <span class="hljs-string">"<span class="hljs-variable">$A</span>"</span> =  <span class="hljs-string">"<span class="hljs-variable">$B</span>"</span> &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Strings are equal"</span>  
  <span class="hljs-built_in">test</span>  <span class="hljs-string">"<span class="hljs-variable">$A</span>"</span>-eq  <span class="hljs-string">"<span class="hljs-variable">$B</span>"</span>  &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Integers are equal"</span> 
[  <span class="hljs-string">"<span class="hljs-variable">$A</span>"</span> =  <span class="hljs-string">"<span class="hljs-variable">$B</span>"</span>  ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Strings are equal"</span>  
[  <span class="hljs-string">"<span class="hljs-variable">$A</span>"</span> -eq <span class="hljs-string">"<span class="hljs-variable">$B</span>"</span> ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Integers are equal"</span> 
[  -f /bin/cat -a -x /bin/cat ] &amp;&amp; cat /etc/fstab 
[  -z  <span class="hljs-string">"<span class="hljs-variable">$HOSTNAME</span>"</span> -o   <span class="hljs-variable">$HOSTNAME</span> = <span class="hljs-string">"localhost.localdomain"</span>  ] &amp;&amp; hostname suosuoli.cn

</div></code></pre>
<h2 id="9%E7%BB%83%E4%B9%A0">9.练习</h2>
<p>1、编写脚本 argsnum.sh，接受一个文件路径作为参数；如果参数个数小于1， 则提示用户“至少应该给一个参数”，并立即退出；如果参数个数不小于1，则显示第一个参数所指向的文件中的空白行数</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-06</span>
 <span class="hljs-comment">#FileName:                  argsum.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 [[ <span class="hljs-variable">$#</span> -lt 1 ]] &amp;&amp; (<span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage:`basename <span class="hljs-variable">$0</span>` /path/to/somefile"</span> &amp;&amp; <span class="hljs-built_in">exit</span>) || grep <span class="hljs-string">"^$"</span> <span class="hljs-variable">$1</span> | wc -l
</div></code></pre>
<p>2、编写脚本 hostping.sh，接受一个主机的IPv4地址做为参数，测试是否可连 通。如果能ping通，则提示用户“该IP地址可访问”；如果不可ping通，则提 示用户“该IP地址不可访问”</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-06</span>
 <span class="hljs-comment">#FileName:                  hostping.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 
 IP=<span class="hljs-string">"\b(([1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([1-9]?[0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\b"</span> 
 <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$1</span> =~ <span class="hljs-variable">$IP</span> ]]; <span class="hljs-keyword">then</span>
     ping -W1 -c1 <span class="hljs-variable">$1</span> &amp;&gt; /etc/null
     <span class="hljs-keyword">if</span> [[ $? -eq 0 ]]; <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\e[1;32mThe host is up.\e[0m"</span> 
     <span class="hljs-keyword">else</span>
         <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\e[1;35mThe host is down!\e[0m"</span>
     <span class="hljs-keyword">fi</span>
 <span class="hljs-keyword">else</span> 
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"It is not a legal ip, please check your input."</span>
 
 <span class="hljs-keyword">fi</span>
 
 <span class="hljs-built_in">unset</span> IP
</div></code></pre>
<p>3、编写脚本 checkdisk.sh，检查磁盘分区空间和inode使用率，如果超过80%，就发广播警告空间将满</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-10</span>
 <span class="hljs-comment">#FileName:                  checkdisk.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           checkdisk.sh</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Fontcolor#red(31):green(32):yellow(33):blue(34):purple(35):cyan(36):white(37)</span>
 <span class="hljs-comment">#Backcolor#red(41):green(42):yellow(43):blue(44):purple(45):cyan(46):white(47)</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#</span>
 
 D_MAX=`df -h | grep -E /dev/\(sd\|nvme\) | egrep -o <span class="hljs-string">"[0-9]{,3}%"</span> | cut -d% -f1 | sort -nr | head -n1`
 I_MAX=`df -hi | grep -E /dev/\(sd\|nvme\) | egrep -o <span class="hljs-string">"[0-9]{,3}%"</span> | cut -d% -f1 | sort -nr | head -n1` 
 THREAD_D=85
 THREAD_I=85
 
 <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$D_MAX</span> -gt <span class="hljs-variable">$THREAD_D</span> ]]; <span class="hljs-keyword">then</span> 
     <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\e[1;31mWarning!\nThe disk space is almost full.\e[0m"</span>
 <span class="hljs-keyword">elif</span> [[ <span class="hljs-variable">$I_MAX</span> -gt <span class="hljs-variable">$THREAD_I</span> ]]; <span class="hljs-keyword">then</span>
     <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\e[1;31mWarning!\nThe inode is almost full.\e[0m"</span>
     
 <span class="hljs-keyword">else</span>
     <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"\e[1;32mNice.\e[0m"</span>
     <span class="hljs-built_in">exit</span> 0
 <span class="hljs-keyword">fi</span>
 
 <span class="hljs-built_in">unset</span> D_MAX
 <span class="hljs-built_in">unset</span> I_MAX
 <span class="hljs-built_in">unset</span> THREAD_D
 <span class="hljs-built_in">unset</span> THREAD_I

</div></code></pre>
<p>4、编写脚本 per.sh，判断当前用户对指定参数文件，是否不可读并且不可写</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-10</span>
 <span class="hljs-comment">#FileName:                  per.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           per.sh</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Fontcolor#red(31):green(32):yellow(33):blue(34):purple(35):cyan(36):white(37)</span>
 <span class="hljs-comment">#Backcolor#red(41):green(42):yellow(43):blue(44):purple(45):cyan(46):white(47)</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#</span>
 
 <span class="hljs-keyword">if</span> [ ! -r <span class="hljs-variable">$1</span> ]; <span class="hljs-keyword">then</span>
     <span class="hljs-keyword">if</span> [ ! -w <span class="hljs-variable">$1</span> ]; <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-string">"Not readable and not writable."</span>
     <span class="hljs-keyword">else</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-string">"Not readable but writable."</span>
     <span class="hljs-keyword">fi</span>
 <span class="hljs-keyword">elif</span> [ -r <span class="hljs-variable">$1</span> ]; <span class="hljs-keyword">then</span>
     <span class="hljs-keyword">if</span> [ ! -w <span class="hljs-variable">$1</span> ]; <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-string">"Readable but not writable."</span>
     <span class="hljs-keyword">else</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-string">"Readable and writable."</span>
     <span class="hljs-keyword">fi</span>
 <span class="hljs-keyword">else</span> 
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"ERROR!"</span>
 <span class="hljs-keyword">fi</span>
</div></code></pre>
<p>5、编写脚本 excute.sh ，判断参数文件是否为sh后缀的普通文件，如果是，添加所有人可执行权限，否则提示用户非脚本文件</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-10</span>
 <span class="hljs-comment">#FileName:                  executable.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           executable.sh</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Fontcolor#red(31):green(32):yellow(33):blue(34):purple(35):cyan(36):white(37)</span>
 <span class="hljs-comment">#Backcolor#red(41):green(42):yellow(43):blue(44):purple(45):cyan(46):white(47)</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#</span>
 
 <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$1</span> =~ \.sh$ ]]; <span class="hljs-keyword">then</span>
     chmod +x <span class="hljs-variable">$1</span>
     <span class="hljs-built_in">echo</span>  -e <span class="hljs-string">"Adding executing permission to <span class="hljs-variable">$1</span>...\nAdded."</span>
 <span class="hljs-keyword">else</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$1</span> is not executable."</span>
 <span class="hljs-keyword">fi</span>
</div></code></pre>
<p>6、编写脚本 nologin.sh和 login.sh，实现禁止和允许普通用户登录系统</p>
<pre class="hljs"><code><div>
 <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-09</span>
 <span class="hljs-comment">#FileName:                  nologin.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 
 <span class="hljs-keyword">if</span> [ -f /etc/nologin ]; <span class="hljs-keyword">then</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"File exists,nobody but root now can login."</span>
 <span class="hljs-keyword">else</span>
     <span class="hljs-built_in">echo</span> System maintenance,deny login! &gt; /etc/nologin
 <span class="hljs-keyword">fi</span>
 
 <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:                        steveli</span>
 <span class="hljs-comment">#QQ:                            1049103823</span>
 <span class="hljs-comment">#Data:                      2019-10-09</span>
 <span class="hljs-comment">#FileName:                  allowLogin.sh</span>
 <span class="hljs-comment">#URL:                   https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:           Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-keyword">if</span> [ -f /etc/nologin ]; <span class="hljs-keyword">then</span> 
     /usr/bin/rm /etc/nologin
 <span class="hljs-keyword">else</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"Everyone can login."</span>
 <span class="hljs-keyword">fi</span>
 

</div></code></pre>
<h2 id="10read%E5%91%BD%E4%BB%A4">10.read命令</h2>
<ul>
<li>使用read命令来接受输入，把输入值分配给一个或多个shell变量
-p  指定要显示的提示
-s  静默输入，一般用于密码
-n  N 指定输入的字符长度N
-d  ‘字符’  输入结束符
-t  N  TIMEOUT为N秒
read 从标准输入中读取值，给每个单词分配一个变量
所有剩余单词都被分配给最后一个变量
read -p &quot;Enter a filename: &quot; FILE
echo $FILE</li>
</ul>
<h1 id="%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%ADif">条件判断if</h1>
<h2 id="1%E5%8D%95%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84">1.单分支结构</h2>
<pre class="hljs"><code><div><span class="hljs-keyword">if</span> 判断条件;<span class="hljs-keyword">then</span> 
    条件为真的分支代码 
<span class="hljs-keyword">fi</span> 
</div></code></pre>
<h2 id="2%E5%8F%8C%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84">2.双分支结构</h2>
<pre class="hljs"><code><div>f 判断条件; <span class="hljs-keyword">then</span> 
    条件为真的分支代码 
<span class="hljs-keyword">else</span> 
    条件为假的分支代码 
<span class="hljs-keyword">fi</span> 

</div></code></pre>
<h2 id="3%E5%A4%9A%E5%88%86%E6%94%AF%E7%BB%93%E6%9E%84">3.多分支结构</h2>
<ul>
<li>逐条件进行判断，第一次遇为“真”条件时，执行其分支;而后结束整个if语句</li>
</ul>
<pre class="hljs"><code><div><span class="hljs-keyword">if</span> 判断条件1; <span class="hljs-keyword">then</span> 
    条件1为真的分支代码 
<span class="hljs-keyword">elif</span> 判断条件2; <span class="hljs-keyword">then</span> 
    条件2为真的分支代码 
<span class="hljs-keyword">elif</span> 判断条件3; <span class="hljs-keyword">then</span> 
    条件3为真的分支代码 
<span class="hljs-keyword">else</span> 
    以上条件都为假的分支代码
<span class="hljs-keyword">fi</span> 
</div></code></pre>
<h1 id="%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%ADcase">条件判断case</h1>
<ul>
<li>case语句支持glob风格的匹配</li>
</ul>
<pre class="hljs"><code><div>    *: 任意长度任意字符
    ?: 任意单个字符
    []：指定范围内的任意单个字符
    a|b: a或b
</div></code></pre>
<pre class="hljs"><code><div><span class="hljs-keyword">case</span> 变量引用 <span class="hljs-keyword">in</span>
PAT1)
    分支1
;;
PAT2)
    分支2
;;
    ...
*)
    默认分支
;;
<span class="hljs-keyword">esac</span>
</div></code></pre>
<h2 id="%E7%BB%83%E4%B9%A0">练习</h2>
<p>1、编写脚本 createuser.sh，实现如下功能：使用一个用户名做为参数，如果
指定参数的用户存在，就显示其存在，否则添加之；显示添加的用户的id号等
信息</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:            steveli</span>
 <span class="hljs-comment">#QQ:                1049103823</span>
 <span class="hljs-comment">#Data:              2019-10-10</span>
 <span class="hljs-comment">#FileName:          createUser.sh</span>
 <span class="hljs-comment">#URL:               https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:       createUser.sh</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Fontcolor#red(31):green(32):yellow(33):blue(34):purple(35):cyan(36):white(37)</span>
 <span class="hljs-comment">#Backcolor#red(41):green(42):yellow(43):blue(44):purple(45):cyan(46):white(47)</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#</span>
 USER_EXIST=2
 <span class="hljs-keyword">if</span> [ <span class="hljs-variable">$#</span> -eq 0 ]; <span class="hljs-keyword">then</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage:`basename <span class="hljs-variable">$0</span>` user"</span>
 <span class="hljs-keyword">else</span>
     <span class="hljs-keyword">if</span> id <span class="hljs-variable">$1</span> &amp;&gt; /dev/null; <span class="hljs-keyword">then</span>
         <span class="hljs-built_in">echo</span> <span class="hljs-string">"User <span class="hljs-variable">$1</span> exists.Exiting..."</span>
         <span class="hljs-built_in">exit</span> <span class="hljs-variable">$USER_EXIST</span>
     <span class="hljs-keyword">else</span>
         useradd <span class="hljs-variable">$1</span>  
         [ $? -eq 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"User <span class="hljs-variable">$1</span> added.\nThe info of <span class="hljs-variable">$1</span> as folloes:\n"</span>
         id <span class="hljs-variable">$1</span>
     <span class="hljs-keyword">fi</span>  
 <span class="hljs-keyword">fi</span>
 <span class="hljs-built_in">unset</span> USER_EXIST
</div></code></pre>
<p>2、编写脚本 yesorno.sh，提示用户输入yes或no,并判断用户输入的是yes还是
no,或是其它信息</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:            steveli</span>
 <span class="hljs-comment">#QQ:                1049103823</span>
 <span class="hljs-comment">#Data:              2019-10-10</span>
 <span class="hljs-comment">#FileName:          yesorno.sh</span>
 <span class="hljs-comment">#URL:               https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:       yesorno.sh</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Fontcolor#red(31):green(32):yellow(33):blue(34):purple(35):cyan(36):white(37)</span>
 <span class="hljs-comment">#Backcolor#red(41):green(42):yellow(43):blue(44):purple(45):cyan(46):white(47)</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-built_in">read</span> -p <span class="hljs-string">"Input yes or no: "</span> ANS 
 <span class="hljs-keyword">case</span> <span class="hljs-variable">$ANS</span> <span class="hljs-keyword">in</span>
 [Yy][Ee][Ss]|[Yy])
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"You'v input yes."</span>
 ;;
 [Nn][Oo]|[Nn])
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"You'v input no."</span>
 ;;
 *)
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"Ni hao tiao a ."</span>
 <span class="hljs-keyword">esac</span>
</div></code></pre>
<p>3、编写脚本 filetype.sh，判断用户输入文件路径，显示其文件类型（普通，目
录，链接，其它文件类型）</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:            steveli</span>
 <span class="hljs-comment">#QQ:                1049103823</span>
 <span class="hljs-comment">#Data:              2019-10-10</span>
 <span class="hljs-comment">#FileName:          exe.sh</span>
 <span class="hljs-comment">#URL:               https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:       Indicate file type.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Fontcolor#red(31):green(32):yellow(33):blue(34):purple(35):cyan(36):white(37)</span>
 <span class="hljs-comment">#Backcolor#red(41):green(42):yellow(43):blue(44):purple(45):cyan(46):white(47)</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#</span>
 
 NUM=<span class="hljs-variable">$#</span>
 <span class="hljs-built_in">declare</span> -i J=0
 
 <span class="hljs-keyword">if</span> [ -f /tmp/mid ]; <span class="hljs-keyword">then</span>
     : &gt; /tmp/mid
 <span class="hljs-keyword">fi</span>
 
 [ <span class="hljs-variable">$#</span> -eq 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"Usage:`basename <span class="hljs-variable">$0</span>` FILE1 [FILE2 ...]"</span>
 
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"$*"</span> | tr -s <span class="hljs-string">" "</span> <span class="hljs-string">"\n"</span> &gt;&gt; /tmp/mid 
 
 <span class="hljs-built_in">exec</span> 6&lt; /tmp/mid
 <span class="hljs-keyword">for</span> ((j=0 ; j&lt;=<span class="hljs-variable">$NUM</span> ; j++)); <span class="hljs-keyword">do</span>
 <span class="hljs-keyword">while</span> <span class="hljs-built_in">read</span> -u 6 I; <span class="hljs-keyword">do</span>
         <span class="hljs-built_in">let</span> J+=1
         <span class="hljs-keyword">if</span> [[ -d <span class="hljs-variable">$I</span> ]]; <span class="hljs-keyword">then</span>
             <span class="hljs-built_in">echo</span> <span class="hljs-string">"File<span class="hljs-variable">$J</span> is a directory."</span>
         <span class="hljs-keyword">elif</span> [[ ! -e <span class="hljs-variable">$I</span> ]]; <span class="hljs-keyword">then</span>
             <span class="hljs-built_in">echo</span> <span class="hljs-string">"File<span class="hljs-variable">$J</span> not exists."</span>
         <span class="hljs-keyword">else</span> 
             C=$(<span class="hljs-built_in">echo</span> $(ls -l <span class="hljs-variable">$I</span> 2&gt; /dev/null) | cut -c1)
             <span class="hljs-keyword">if</span> [[ <span class="hljs-string">"<span class="hljs-variable">$C</span>"</span> = <span class="hljs-string">"-"</span> ]]; <span class="hljs-keyword">then</span>
                 <span class="hljs-built_in">echo</span> <span class="hljs-string">"File<span class="hljs-variable">$J</span> is a normal file."</span>
             <span class="hljs-comment">#elif [[ "$C" = "d" ]]; then</span>
             <span class="hljs-comment">#    echo "File$J is a directory."</span>
             <span class="hljs-keyword">elif</span> [[ <span class="hljs-string">"<span class="hljs-variable">$C</span>"</span> = <span class="hljs-string">"b"</span> ]]; <span class="hljs-keyword">then</span>
                 <span class="hljs-built_in">echo</span> <span class="hljs-string">"File<span class="hljs-variable">$J</span> is a block device file."</span>
             <span class="hljs-keyword">elif</span> [[ <span class="hljs-string">"<span class="hljs-variable">$C</span>"</span> = <span class="hljs-string">"c"</span> ]]; <span class="hljs-keyword">then</span>
                 <span class="hljs-built_in">echo</span> <span class="hljs-string">"File<span class="hljs-variable">$J</span> is a character device file."</span>
             <span class="hljs-keyword">elif</span> [[ <span class="hljs-string">"<span class="hljs-variable">$C</span>"</span> = <span class="hljs-string">"l"</span> ]]; <span class="hljs-keyword">then</span>
                 <span class="hljs-built_in">echo</span> <span class="hljs-string">"File<span class="hljs-variable">$J</span> is a symbolic link."</span>
             <span class="hljs-keyword">elif</span> [[ <span class="hljs-string">"<span class="hljs-variable">$C</span>"</span> = <span class="hljs-string">"p"</span> ]]; <span class="hljs-keyword">then</span>
                 <span class="hljs-built_in">echo</span> <span class="hljs-string">"File<span class="hljs-variable">$J</span> is a pipe."</span>
             <span class="hljs-keyword">elif</span> [[ <span class="hljs-string">"<span class="hljs-variable">$C</span>"</span> = <span class="hljs-string">"s"</span> ]]; <span class="hljs-keyword">then</span>
                 <span class="hljs-built_in">echo</span> <span class="hljs-string">"File<span class="hljs-variable">$J</span> is a socket."</span>
             <span class="hljs-keyword">fi</span>  
         <span class="hljs-keyword">fi</span>  
 <span class="hljs-keyword">done</span>
 <span class="hljs-keyword">done</span>
</div></code></pre>
<p>4、编写脚本 checkint.sh，判断用户输入的参数是否为正整数</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Author:            steveli</span>
 <span class="hljs-comment">#QQ:                1049103823</span>
 <span class="hljs-comment">#Data:              2019-10-06</span>
 <span class="hljs-comment">#FileName:          checkint.sh</span>
 <span class="hljs-comment">#URL:               https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:       Test scrpting.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 PATTERN=<span class="hljs-string">"^([^-]|[0-9]+)?[0-9]+$"</span>
 <span class="hljs-keyword">if</span> [[ <span class="hljs-variable">$1</span> =~ <span class="hljs-variable">$PATTERN</span> ]]; <span class="hljs-keyword">then</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$1</span> is a unsigned int."</span>
 <span class="hljs-keyword">else</span>
     <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">$1</span> is not a unsigned int."</span>
 <span class="hljs-keyword">fi</span>
 <span class="hljs-built_in">unset</span> PATTERN
</div></code></pre>
<h1 id="%E9%85%8D%E7%BD%AE%E7%94%A8%E6%88%B7%E7%8E%AF%E5%A2%83">配置用户环境</h1>
<h2 id="1bash%E5%B1%95%E5%BC%80%E5%91%BD%E4%BB%A4%E8%A1%8C%E7%9A%84%E4%BC%98%E5%85%88%E6%AC%A1%E5%BA%8F%E4%BC%98%E5%85%88%E7%BA%A7">1.bash展开命令行的优先次序(优先级)</h2>
<pre class="hljs"><code><div>graph TD
A(把命令行分成单个命令词) --&gt;B(展开别名)
B--&gt;C(展开大括号的声明)
C--&gt;D(展开波浪符声明)
D--&gt;E(命令替换)
E--&gt;F(再次把命令行分成命令词)
F--&gt;G(展开文件通配)
G--&gt;H(准备I/0重定向)
H--&gt;I(运行命令)
</div></code></pre>
<h2 id="2%E9%98%B2%E6%AD%A2bash%E6%89%A9%E5%B1%95%E6%9F%90%E4%BA%9B%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6">2.防止bash扩展某些特殊字符</h2>
<pre class="hljs"><code><div>反斜线（\）会使随后的字符按原意解释 
    <span class="hljs-built_in">echo</span> Your cost: \<span class="hljs-variable">$5</span>.00  
     Your cost: <span class="hljs-variable">$5</span>.00 
加引号来防止扩展 
•单引号（’’）防止所有扩展 
•双引号（”“）也可防止扩展，但是以下情况例外： 
    $（美元符号） 变量扩展 
    ` ` (反引号）    命令替换 
    \（反斜线）   禁止单个字符扩展 
    !（叹号）     历史命令替换 
</div></code></pre>
<h2 id="3bash%E7%9A%84%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6">3.bash的配置文件</h2>
<ul>
<li>按生效范围划分，存在两类：</li>
</ul>
<pre class="hljs"><code><div>全局配置： 
    /etc/profile 
    /etc/profile.d/*.sh 
    /etc/bashrc 
个人配置： 
    ~/.bash_profile 
    ~/.bashrc 
</div></code></pre>
<ul>
<li>按功能划分，存在两类：</li>
</ul>
<pre class="hljs"><code><div>Profile类 
profile类：为交互式登录的shell提供配置 
    全局：/etc/profile, /etc/profile.d/*.sh 
    个人：~/.bash_profile 
功用： 
    (1) 用于定义环境变量 
    (2) 运行命令或脚本 
</div></code></pre>
<pre class="hljs"><code><div>Bashrc类 
bashrc类：为非交互式和交互式登录的shell提供配置 
    全局：/etc/bashrc 
    个人：~/.bashrc 
功用： 
    (1) 定义命令别名和函数 
    (2) 定义本地变量 
</div></code></pre>
<h2 id="4shell%E7%99%BB%E5%BD%95%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F">4.shell登录两种方式</h2>
<ul>
<li>交互式登录：</li>
</ul>
<pre class="hljs"><code><div> (1)直接通过终端输入账号密码登录 
 (2)使用“su - UserName” 切换的用户 
执行顺序：/etc/profile --&gt; /etc/profile.d/*.sh --&gt; ~/.bash_profile --&gt; 
~/.bashrc --&gt; /etc/bashrc 
</div></code></pre>
<ul>
<li>非交互式登录：</li>
</ul>
<pre class="hljs"><code><div> (1)su UserName 
 (2)图形界面下打开的终端 
 (3)执行脚本 
 (4)任何其它的bash实例 
 执行顺序： /etc/profile.d/*.sh --&gt; /etc/bashrc --&gt;~/.bashrc  
</div></code></pre>
<h2 id="5%E7%BC%96%E8%BE%91%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E5%90%8E%E4%BD%BF%E5%85%B6%E7%94%9F%E6%95%88%E7%9A%84%E6%96%B9%E5%BC%8F">5.编辑配置文件后使其生效的方式</h2>
<pre class="hljs"><code><div>修改profile和bashrc文件后需生效 
两种方法: 
1重新启动shell进程 
2使用.命令或<span class="hljs-built_in">source</span> 命令 
例: 
    .   ~/.bashrc 
</div></code></pre>
<ul>
<li>退出登录时让Bash执行退出任务</li>
</ul>
<pre class="hljs"><code><div>任务保存在~/.bash_logout文件中（用户） 
在退出登录shell时运行 
作用 
    •创建自动备份 
    •清除临时文件 
</div></code></pre>
<h2 id="6set%E5%91%BD%E4%BB%A4%E5%92%8C-%E5%8F%98%E9%87%8F">6.set命令和$-变量</h2>
<ul>
<li>$- 变量保存shell的一些功能开关</li>
</ul>
<pre class="hljs"><code><div>h：hashall，打开这个选项后，Shell 会将命令所在的路径<span class="hljs-built_in">hash</span>下来，避免每
次都要查询。通过<span class="hljs-built_in">set</span> +h将h选项关闭 
i：interactive-comments，包含这个选项说明当前的 shell 是一个交互式的 
shell。所谓的交互式shell,在脚本中，i选项是关闭的 
m：monitor，打开监控模式，就可以通过Job control来控制进程的停止、继
续，后台或者前台执行等 
B：braceexpand，大括号扩展 
H：<span class="hljs-built_in">history</span>，H选项打开，可以展开历史列表中的命令，可以通过!感叹号来
完成，例如“!!”返回上最近的一个历史命令，“!n”返回第 n 个历史命令 
</div></code></pre>
<h2 id="7%E8%84%9A%E6%9C%AC%E5%AE%89%E5%85%A8%E7%9B%B8%E5%85%B3">7.脚本安全相关</h2>
<ul>
<li>使用set命令可以避免一些灾难性的错误</li>
</ul>
<pre class="hljs"><code><div>-u     在扩展一个没有设置的变量时，显示错误信息 
        等同<span class="hljs-built_in">set</span> -o nounset 
-e    如果一个命令返回一个非0退出状态值(失败)就退出 
        等同<span class="hljs-built_in">set</span> -o errexit 
</div></code></pre>
<h2 id="8%E7%BB%83%E4%B9%A0">8.练习</h2>
<p>1、让所有用户的PATH环境变量的值多出一个路径，例如：
/usr/local/apache/bin</p>
<pre class="hljs"><code><div><span class="hljs-built_in">echo</span> <span class="hljs-string">"PATH=/usr/local/apache/bin:<span class="hljs-variable">$PATH</span>"</span> &gt;&gt; /etc/profile.d/env.sh
</div></code></pre>
<p>2、用户 root 登录时，将命令指示符变成红色，并自动启用如下别名：</p>
<pre class="hljs"><code><div><span class="hljs-built_in">echo</span> <span class="hljs-string">"PATH=/usr/local/apache/bin:<span class="hljs-variable">$PATH</span>"</span> &gt;&gt; /etc/profile.d/env.sh 
cat &lt;&lt;EOF
rm=‘rm –i’ 
cdnet=‘<span class="hljs-built_in">cd</span> /etc/sysconfig/network-scripts/’ 
editnet=‘vim /etc/sysconfig/network-scripts/ifcfg-eth0’ 
<span class="hljs-comment">######</span>
V=`cat /etc/redhat-release | grep -o <span class="hljs-string">"[0-9]\+"</span> | cut -d. -f1 | head -n1`
NET0=iifconfig | grep -o <span class="hljs-string">"ens[0-9]\+"</span> | cut -ds -f2 | head -n1 
NET1=iifconfig | grep -o <span class="hljs-string">"ens[0-9]\+"</span> | cut -ds -f2 | head -n2 | tail -n1 
<span class="hljs-keyword">if</span> [ <span class="hljs-variable">$V</span> = 7 ]; <span class="hljs-keyword">then</span>
<span class="hljs-built_in">alias</span>    editnet=<span class="hljs-string">'vim /etc/sysconfig/network-scripts/ifcfg-ens33'</span>
<span class="hljs-keyword">elif</span> [ <span class="hljs-variable">$V</span> = 8 ]; <span class="hljs-keyword">then</span>
<span class="hljs-built_in">alias</span>    editnet0=<span class="hljs-string">'vim /etc/sysconfig/network-scripts/ifcfg-ens160'</span>
<span class="hljs-built_in">alias</span>    editnet1=<span class="hljs-string">'vim /etc/sysconfig/network-scripts/ifcfg-ens192'</span>
<span class="hljs-keyword">fi</span>
EOF
</div></code></pre>
<p>3、任意用户登录系统时，显示红色字体的警示提醒信息“Hi,dangerous！”</p>
<pre class="hljs"><code><div><span class="hljs-built_in">echo</span> <span class="hljs-string">'echo -e "\e[1;31mHi,dangerous!\e[0m"'</span> &gt; /etc/profile.d/Warning.sh
</div></code></pre>
<p>4、编写生成脚本基本格式的脚本，包括作者，联系方式，版本，时间，描述等</p>
<pre class="hljs"><code><div> <span class="hljs-built_in">set</span> number
 <span class="hljs-built_in">set</span> tabstop=4
 <span class="hljs-built_in">set</span> softtabstop=4
 <span class="hljs-built_in">set</span> shiftwidth=4
 <span class="hljs-built_in">set</span> expandtab 
 <span class="hljs-built_in">set</span> ignorecase
 <span class="hljs-built_in">set</span> cursorline
 <span class="hljs-built_in">set</span> autoindent
 autocmd BufNewFile *.sh <span class="hljs-built_in">exec</span> <span class="hljs-string">":call SetTitle()"</span>
 func SetTitle()
     <span class="hljs-keyword">if</span> expand(<span class="hljs-string">"%:e"</span>) == <span class="hljs-string">'sh'</span>
         call setline(1,<span class="hljs-string">"#!/bin/bash"</span>)
         call setline(2,<span class="hljs-string">"#"</span>)
         call setline(3,<span class="hljs-string">"#*******************************************************************************"</span>)
         call setline(4,<span class="hljs-string">"#Author:            steveli"</span>)
         call setline(5,<span class="hljs-string">"#QQ:                1049103823"</span>)
         call setline(6,<span class="hljs-string">"#Data:              "</span>.strftime(<span class="hljs-string">"%Y-%m-%d"</span>))
         call setline(7,<span class="hljs-string">"#FileName:          "</span>.expand(<span class="hljs-string">"%"</span>))
         call setline(8,<span class="hljs-string">"#URL:               https://blog.csdn.net/YouOops"</span>)
         call setline(9,<span class="hljs-string">"#Description:       "</span>.expand(<span class="hljs-string">"%"</span>))
         call setline(10,<span class="hljs-string">"#Copyright (C):        "</span>.strftime(<span class="hljs-string">"%Y"</span>).<span class="hljs-string">" All rights reserved"</span>)
         call setline(11,<span class="hljs-string">"#*******************************************************************************"</span>)
         call setline(12,<span class="hljs-string">"#Fontcolor#red(31):green(32):yellow(33):blue(34):purple(35):cyan(36):white(37)"</span>)
         call setline(13,<span class="hljs-string">"#Backcolor#red(41):green(42):yellow(43):blue(44):purple(45):cyan(46):white(47)"</span>)
         call setline(14,<span class="hljs-string">"#*******************************************************************************"</span>)
         call setline(15,<span class="hljs-string">"#"</span>)
         call setline(16,<span class="hljs-string">""</span>)
         endif
 endfunc
 autocmd BufNewFile * normal G
</div></code></pre>
<p>5、编写用户的环境初始化脚本reset.sh，包括别名，登录提示符，vim的设置，
环境变量等</p>
<pre class="hljs"><code><div> <span class="hljs-comment">#!/bin/bash</span>
 <span class="hljs-comment">#</span>
 <span class="hljs-comment">#******************************************************************************* </span>
 <span class="hljs-comment">#Author:            steveli</span>
 <span class="hljs-comment">#QQ:                1049103823</span>
 <span class="hljs-comment">#Data:              2019-08-29</span>
 <span class="hljs-comment">#FileName:          reset6.sh</span>
 <span class="hljs-comment">#URL:               https://blog.csdn.net/YouOops</span>
 <span class="hljs-comment">#Description:       This script doing some init configurations on centos7&amp;8.</span>
 <span class="hljs-comment">#Copyright (C):     2019 All rights reserved</span>
 <span class="hljs-comment">#******************************************************************************</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 <span class="hljs-comment">#Fontcolor#red(31):green(32):yellow(33):blue(34):purple(35):cyan(36):white(37)</span>
 <span class="hljs-comment">#Backcolor#red(41):green(42):yellow(43):blue(44):purple(45):cyan(46):white(47)</span>
 <span class="hljs-comment">#*******************************************************************************</span>
 VIMRC=~/.vimrc
 BASHRC=~/.bashrc
 PROMPT_PATH=/etc/profile.d/
 HOSTNAME=stevenux
 HOSTNAME_PATH=/etc/hostname
 HOSTS_PATH=/etc/hosts
 
 <span class="hljs-comment">#1.Prompt configuration</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"1.Entering to /etc/profile.d/ ..."</span>
 
 sleep 1
 <span class="hljs-built_in">cd</span> <span class="hljs-variable">$PROMPT_PATH</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"Create env.sh..."</span>
 sleep 1
 
 <span class="hljs-keyword">if</span> [ ! -e <span class="hljs-variable">${PROMPT_PATH}</span>/env.sh ]; <span class="hljs-keyword">then</span>
 touch env.sh
 cat &gt;&gt; env.sh &lt;&lt;EOF
 <span class="hljs-comment">#!/bin/bash</span>
 PS1=<span class="hljs-string">"\[\e[37;40m\][\[\e[32;40m\]\u\[\e[37;40m\]@\h \[\e[36;40m\]\w\[\e[0m\]]\$"</span>
 EOF
 <span class="hljs-keyword">fi</span>
 
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"Change prompt style..."</span>
 . /etc/profile.d/env.sh
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"1.done"</span>
 <span class="hljs-built_in">echo</span> 
 
 
 <span class="hljs-comment">#2.VIM style configuration</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"2.VIM style configuration..."</span>
 sleep 1
 
 <span class="hljs-keyword">if</span> [ ! -f <span class="hljs-variable">$VIMRC</span> ];<span class="hljs-keyword">then</span>
 touch <span class="hljs-variable">$VIMRC</span>
 cat &gt;&gt; <span class="hljs-variable">$VIMRC</span> &lt;&lt;EOF
 <span class="hljs-built_in">set</span> number
 <span class="hljs-built_in">set</span> tabstop=4
 <span class="hljs-built_in">set</span> softtabstop=4
 <span class="hljs-built_in">set</span> shiftwidth=4
 <span class="hljs-built_in">set</span> expandtab 
 <span class="hljs-built_in">set</span> ignorecase
 <span class="hljs-built_in">set</span> cursorline
 <span class="hljs-built_in">set</span> autoindent
 autocmd BufNewFile *.sh <span class="hljs-built_in">exec</span> <span class="hljs-string">":call SetTitle()"</span>
 func SetTitle()
     <span class="hljs-keyword">if</span> expand(<span class="hljs-string">"%:e"</span>) == <span class="hljs-string">'sh'</span>
         call setline(1,<span class="hljs-string">"#!/bin/bash"</span>)
         call setline(2,<span class="hljs-string">"#"</span>)
 call setline(1,<span class="hljs-string">"#!/bin/bash"</span>)                                                                                                                                                                            
         call setline(2,<span class="hljs-string">"#"</span>)
         call setline(3,<span class="hljs-string">"#*******************************************************************************"</span>)
         call setline(4,<span class="hljs-string">"#Author:            steveli"</span>)
         call setline(5,<span class="hljs-string">"#QQ:                1049103823"</span>)
         call setline(6,<span class="hljs-string">"#Data:              "</span>.strftime(<span class="hljs-string">"%Y-%m-%d"</span>))
         call setline(7,<span class="hljs-string">"#FileName:          "</span>.expand(<span class="hljs-string">"%"</span>))
         call setline(8,<span class="hljs-string">"#URL:               https://blog.csdn.net/YouOops"</span>)
         call setline(9,<span class="hljs-string">"#Description:       Test scrpting."</span>) 
         call setline(10,<span class="hljs-string">"#Copyright (C):        "</span>.strftime(<span class="hljs-string">"%Y"</span>).<span class="hljs-string">" All rights reserved"</span>)
         call setline(11,<span class="hljs-string">"#******************************************************************************"</span>)
         call setline(12,<span class="hljs-string">""</span>)
         endif
 endfunc
 autocmd BufNewFile * normal G
 EOF
 <span class="hljs-keyword">fi</span>
 . <span class="hljs-variable">$VIMRC</span> &amp;&gt; /dev/null
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"2.done"</span>
 <span class="hljs-built_in">echo</span>
 
 
 <span class="hljs-comment">#3.BASH style configuration.</span>
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"3.BASH style changing..."</span>
 sleep 1
 
 <span class="hljs-keyword">if</span> [ -e <span class="hljs-variable">$BASHRC</span> ]; <span class="hljs-keyword">then</span>
 cat &gt;&gt; <span class="hljs-variable">$BASHRC</span> &lt;&lt;EOF
 <span class="hljs-comment">#my customized command</span>
 <span class="hljs-built_in">alias</span> rm=<span class="hljs-string">'rm -i'</span>
 <span class="hljs-built_in">alias</span> cp=<span class="hljs-string">'cp -i'</span>
 <span class="hljs-built_in">alias</span> mv=<span class="hljs-string">'mv -i'</span>
 <span class="hljs-built_in">alias</span> ll=<span class="hljs-string">'ls -l'</span>
 <span class="hljs-built_in">alias</span> la=<span class="hljs-string">'ls -a'</span>
 <span class="hljs-built_in">alias</span> cls=<span class="hljs-string">'clear'</span>
 <span class="hljs-built_in">alias</span> scandisk=<span class="hljs-string">'echo - - - &gt; /sys/clss/scsi_host/host2/scan'</span>
 <span class="hljs-built_in">alias</span> cdnet=<span class="hljs-string">'cd /etc/sysconfig/network-scripts'</span>
 <span class="hljs-built_in">alias</span> netstat=<span class="hljs-string">'netstat -ntupa'</span>
 <span class="hljs-built_in">alias</span> route=<span class="hljs-string">'route -n'</span>
 <span class="hljs-built_in">alias</span> arp=<span class="hljs-string">'arp -n'</span>
 <span class="hljs-built_in">alias</span> ipr=<span class="hljs-string">'ip route'</span>
 <span class="hljs-built_in">alias</span> ipl=<span class="hljs-string">'ip link'</span>
 <span class="hljs-built_in">alias</span> cdnet=<span class="hljs-string">'cd /etc/sysconfig/network-scripts'</span>
 <span class="hljs-built_in">alias</span> bashn=<span class="hljs-string">'bash -n'</span>
 <span class="hljs-built_in">alias</span> bashx=<span class="hljs-string">'bash -x'</span>
 <span class="hljs-built_in">alias</span> freeh=<span class="hljs-string">'free -h'</span>
 <span class="hljs-built_in">alias</span> yy=<span class="hljs-string">'yum install -y'</span>
 <span class="hljs-built_in">alias</span> ee=<span class="hljs-string">'echo $?'</span>
 EOF
 <span class="hljs-keyword">else</span>
     touch <span class="hljs-variable">$BASHRC</span>
 cat &gt;&gt; <span class="hljs-variable">$BASHRC</span> &lt;&lt;EOF
 <span class="hljs-comment">#my customized command</span>
 <span class="hljs-built_in">alias</span> rm=<span class="hljs-string">'rm -i'</span>
 <span class="hljs-built_in">alias</span> cp=<span class="hljs-string">'cp -i'</span>
 <span class="hljs-built_in">alias</span> mv=<span class="hljs-string">'mv -i'</span>
 <span class="hljs-built_in">alias</span> ll=<span class="hljs-string">'ls -l'</span>
 <span class="hljs-built_in">alias</span> la=<span class="hljs-string">'ls -a'</span>
 <span class="hljs-built_in">alias</span> cls=<span class="hljs-string">'clear'</span>
 <span class="hljs-built_in">alias</span> scandisk=<span class="hljs-string">'echo - - - &gt; /sys/clss/scsi_host/host2/scan'</span>
 <span class="hljs-built_in">alias</span> cdnet=<span class="hljs-string">'cd /etc/sysconfig/network-scripts'</span>
 <span class="hljs-built_in">alias</span> netstat=<span class="hljs-string">'netstat -ntupa'</span>
 <span class="hljs-built_in">alias</span> route=<span class="hljs-string">'route -n'</span>
 <span class="hljs-built_in">alias</span> arp=<span class="hljs-string">'arp -n'</span>
 <span class="hljs-built_in">alias</span> ipr=<span class="hljs-string">'ip route'</span>
 <span class="hljs-built_in">alias</span> arp=<span class="hljs-string">'arp -n'</span>                                                                                                                                                                                               
 <span class="hljs-built_in">alias</span> ipr=<span class="hljs-string">'ip route'</span>
 <span class="hljs-built_in">alias</span> ipl=<span class="hljs-string">'ip link'</span>
 <span class="hljs-built_in">alias</span> cdnet=<span class="hljs-string">'cd /etc/sysconfig/network-scripts'</span>
 <span class="hljs-built_in">alias</span> bashn=<span class="hljs-string">'bash -n'</span>
 <span class="hljs-built_in">alias</span> bashx=<span class="hljs-string">'bash -x'</span>
 <span class="hljs-built_in">alias</span> freeh=<span class="hljs-string">'free -h'</span>
 <span class="hljs-built_in">alias</span> yy=<span class="hljs-string">'yum install -y'</span>
 <span class="hljs-built_in">alias</span> ee=<span class="hljs-string">'echo $?'</span>
 EOF
 . <span class="hljs-variable">$BASHRC</span> &amp;&gt; /dev/null
 <span class="hljs-keyword">fi</span>
 
 <span class="hljs-built_in">echo</span> <span class="hljs-string">"3.done"</span>
 <span class="hljs-built_in">echo</span>
 
 <span class="hljs-comment">#4,5,6 From Jibill Chen:Contact him:http://www.jibiao.work</span>
 <span class="hljs-comment">#4.Configure cd_rom for yum.</span>
 <span class="hljs-comment">#CD_NAME=$(lsblk | grep 'sr[0-9]'|head -1 | cut -c 1,2,3)</span>
 <span class="hljs-comment">#[ $(df | grep 'sr' | wc -l) -ge 1 ] &amp;&amp; CD_MOUNT_POINT=$(df |sed -nr '/dev\/sr/s@^/dev.*% @@p') || { mount /dev/$CD_NAME /mnt &amp;&gt; /dev/null ; CD_MOUNT_POINT='/mnt';}</span>
 mkdir -p /mnt/cdrom &amp;&gt; /dev/null
 CD_MOUNT_POINT=<span class="hljs-string">"/mnt/cdrom"</span>
 umount /dev/sr0 &amp;&gt; /dev/null
 mount /dev/sr0 <span class="hljs-variable">$CD_MOUNT_POINT</span> &amp;&gt; /dev/null
 rm -f /etc/yum.repos.d/*.repo &amp;&gt; /dev/null
 cat &gt; /etc/yum.repos.d/cdrom.repo &lt;&lt; EOF
 [cdrom]
 name=cdrom
 baseurl=file://<span class="hljs-variable">${CD_MOUNT_POINT}</span>
         https://mirrors.aliyun.com/epel/7/x86_64/
 enabled=1
 gpgcheck=0
 EOF
 [ $? -eq 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_GREEN}</span>Configure yum of cdrom successful!<span class="hljs-variable">${LOR}</span>"</span> || <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>Configure yum of cdrom fail!<span class="hljs-variable">${LOR}</span>"</span>
 sleep 1
 
 <span class="hljs-comment">#5.Install tree screen vim bzip2  </span>
 yum clean all &amp;&gt; /dev/null
 yum repolist &amp;&gt; /dev/null
 yum -y install chrony  &amp;&gt; /dev/null
 [ $? -eq 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_GREEN}</span>install chrony successful!<span class="hljs-variable">${LOR}</span>"</span> || <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>install tree fail!<span class="hljs-variable">${LOR}</span>"</span>
 yum -y install wget tree &amp;&gt; /dev/null
 [ $? -eq 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_GREEN}</span>install wget tree successful!<span class="hljs-variable">${LOR}</span>"</span> || <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>install tree fail!<span class="hljs-variable">${LOR}</span>"</span>
 yum -y install screen net-tools &amp;&gt; /dev/null
 [ $? -eq 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_GREEN}</span>install screen net-tools successful!<span class="hljs-variable">${LOR}</span>"</span> || <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>install tree fail!<span class="hljs-variable">${LOR}</span>"</span>
 yum -y install  vim bzip2 &amp;&gt; /dev/null
 [ $? -eq 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_GREEN}</span>install vim bzip2 successful!<span class="hljs-variable">${LOR}</span>"</span> || <span class="hljs-built_in">echo</span> -e <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>install tree fail!<span class="hljs-variable">${LOR}</span>"</span>
 
 <span class="hljs-comment">#6.Disable iptables and firewalld</span>
 <span class="hljs-comment">#</span>
 systemctl stop firewalld &amp;&gt; /dev/null
 [ $? -ne 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>stop firewalld fail<span class="hljs-variable">${LOR}</span>"</span> 
 systemctl <span class="hljs-built_in">disable</span> firewalld &amp;&gt; /dev/null
 [ $? -ne 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>disable firewalld fail<span class="hljs-variable">${LOR}</span>"</span>
 iptables -F &amp;&gt; /dev/null
 [ $? -ne 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>shutdown iptables fail<span class="hljs-variable">${LOR}</span>"</span>
 sed -r -i <span class="hljs-string">'s#(^SELINUX=)(.*$)#\1disabled#'</span> /etc/selinux/config &amp;&gt; /dev/null
 [ $? -ne 0 ] &amp;&amp; <span class="hljs-built_in">echo</span> <span class="hljs-string">"<span class="hljs-variable">${CO_RED}</span>modify selinux/config fail<span class="hljs-variable">${LOR}</span>"</span>
</div></code></pre>

</body>
</html>
