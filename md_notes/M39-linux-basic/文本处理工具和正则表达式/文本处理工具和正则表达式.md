<center><font size=214 face=黑体 color=grey> Linux文本处理工具和正则表达式</font></center>

# 一.查看、截取和修改文本的工具

## 1.查看文本的工具

### cat

- 最常用的文件查看命令；当不指明文件或者文件名为一杠'-'时，读取标准输入。

```bash
cat [OPTION]... [FILE]...
-A：显示所有控制符(tab键:^I;行结束符:$)  
-E：显示行结束符$
-n：对显示出的每一行进行编号
-b：只对非空行进行编号
-s：压缩连续的空行成一行
```

### more

- 默认将多行文本满屏输出,只允许向文本末尾翻页（空格键满屏翻页；回车键单行翻页），阅读到文末自动退出。
- 用法

```bash
more [options] file...
```

- 一般使用管道传给more来阅读内容超过满屏的文本

```bash
cat big_file1 | more
```

### less

- 功能和more类似，但是允许向前和向后翻页，阅读到文本末尾不会自动退出。
- 另外，less不必读取完整的文本，这使得其打开较大的文本文件时比vi等工具更具有速度优势。
- 翻页快捷键

|||
|---|---|
|空格键向下满屏翻页||
|回车键单行向下翻页||
|k键单行向上||
|u键半屏向上||
|f键半屏向下||

- 向下的快捷键同样适用于more

### nl

- nl将文本文件传给标准输出，并添给每行文本加行号；当不指明文件或者文件名为一杠'-'时，读取标准输入。
- 用法

```bash
nl [OPTION]... [FILE]...
    -i#   # 表示行号间隔#个数递增
```

- 下面的用法只给带root的行加行号（匹配基本正则表达式）

```bash
nl -b, --body-numbering=pBRE file             # BRE 表示基本正则表达式
nl --body-numbering=proot /etc/passwd
```

### tac

- cat 的反用，最后一行先显示；当不指明文件或者文件名为一杠'-'时，读取标准输入。

### rev

- rev读取指定的文件，倒序每行的字符，输出到标准输出；如果不指定文件，读取标准输入。

```bash
[root@centos8 ~]$ rev
hello    # 输入
olleh    # 输出
howdy    # 输入
ydwoh    # 输出

```

## 2.查看非文本文件的工具

### hexdump

- hexdump 将文件内容以ascii字符, decimal十进制, hexadecimal十六进制, 或者octal八进制显示在标准输出。

- 用法

```bash
 hexdump [options] file [...]
    -C # 大写C字母表示按照标准的16进制ASCII码显示文件内容
    -n length # 只显示前n字节的内容
    -s offset # 跳过文件内容的前offset个字节显示
注：length和offset的格式为：1KiB=1024字节；1MiB=1024KiB；... 或者：1KB=1000字节;1MB=1000KB...
也就是说下面的写法等价：
[root@centos8 /data]$ hexdump -C -n 1KiB /dev/nvme0n1 | wc -l
56                                  ^^^^
[root@centos8 /data]$ hexdump -C -n 1024 /dev/nvme0n1 | wc -l
56                                  ^^^^
[root@centos8 /data]$ hexdump -C -n 1KiB /dev/nvme0n1 | tail -n3
*
000003f0  00 00 00 00 02 00 00 00  00 00 00 00 77 00 20 08  |............w. .|
00000400
[root@centos8 /data]$ hexdump -C -n 1024 /dev/nvme0n1 | tail -n3
000003f0  00 00 00 00 02 00 00 00  00 00 00 00 77 00 20 08  |............w. .|
00000400

[root@centos8 /data]$hexdump -C -n 1KB /dev/nvme0n1 | tail -n3
*                                  ^^^
000003e0  00 00 00 00 00 00 00 00                           |........|
000003e8
[root@centos8 /data]$hexdump -C -n 1000 /dev/nvme0n1 | tail -n3  
*                                  ^^^^
000003e0  00 00 00 00 00 00 00 00                           |........|
000003e8
```

```bash
[root@centos8 /data]$ hexdump  -C -n 512 /dev/nvme0n1    # 查看MBR
00000000  eb 63 90 10 8e d0 bc 00  b0 b8 00 00 8e d8 8e c0  |.c..............|
00000010  fb be 00 7c bf 00 06 b9  00 02 f3 a4 ea 21 06 00  |...|.........!..|
00000020  00 be be 07 38 04 75 0b  83 c6 10 81 fe fe 07 75  |....8.u........u|
00000030  f3 eb 16 b4 02 b0 01 bb  00 7c b2 80 8a 74 01 8b  |.........|...t..|
00000040  4c 02 cd 13 ea 00 7c 00  00 eb fe 00 00 00 00 00  |L.....|.........|
00000050  00 00 00 00 00 00 00 00  00 00 00 80 01 00 00 00  |................|
00000060  00 00 00 00 ff fa 90 90  f6 c2 80 74 05 f6 c2 70  |...........t...p|
00000070  74 02 b2 80 ea 79 7c 00  00 31 c0 8e d8 8e d0 bc  |t....y|..1......|
00000080  00 20 fb a0 64 7c 3c ff  74 02 88 c2 52 be 05 7c  |. ..d|<.t...R..||
00000090  b4 41 bb aa 55 cd 13 5a  52 72 3d 81 fb 55 aa 75  |.A..U..ZRr=..U.u|
000000a0  37 83 e1 01 74 32 31 c0  89 44 04 40 88 44 ff 89  |7...t21..D.@.D..|
000000b0  44 02 c7 04 10 00 66 8b  1e 5c 7c 66 89 5c 08 66  |D.....f..\|f.\.f|
000000c0  8b 1e 60 7c 66 89 5c 0c  c7 44 06 00 70 b4 42 cd  |..\`|f.\..D..p.B.|
000000d0  13 72 05 bb 00 70 eb 76  b4 08 cd 13 73 0d 5a 84  |.r...p.v....s.Z.|
000000e0  d2 0f 83 de 00 be 85 7d  e9 82 00 66 0f b6 c6 88  |.......}...f....|
000000f0  64 ff 40 66 89 44 04 0f  b6 d1 c1 e2 02 88 e8 88  |d.@f.D..........|
00000100  f4 40 89 44 08 0f b6 c2  c0 e8 02 66 89 04 66 a1  |.@.D.......f..f.|
00000110  60 7c 66 09 c0 75 4e 66  a1 5c 7c 66 31 d2 66 f7  |\`|f..uNf.\|f1.f.|
00000120  34 88 d1 31 d2 66 f7 74  04 3b 44 08 7d 37 fe c1  |4..1.f.t.;D.}7..|
00000130  88 c5 30 c0 c1 e8 02 08  c1 88 d0 5a 88 c6 bb 00  |..0........Z....|
00000140  70 8e c3 31 db b8 01 02  cd 13 72 1e 8c c3 60 1e  |p..1......r...\`.|
00000150  b9 00 01 8e db 31 f6 bf  00 80 8e c6 fc f3 a5 1f  |.....1..........|
00000160  61 ff 26 5a 7c be 80 7d  eb 03 be 8f 7d e8 34 00  |a.&Z|..}....}.4.|
00000170  be 94 7d e8 2e 00 cd 18  eb fe 47 52 55 42 20 00  |..}.......GRUB .|
00000180  47 65 6f 6d 00 48 61 72  64 20 44 69 73 6b 00 52  |Geom.Hard Disk.R|
00000190  65 61 64 00 20 45 72 72  6f 72 0d 0a 00 bb 01 00  |ead. Error......|
000001a0  b4 0e cd 10 ac 3c 00 75  f4 c3 00 00 00 00 00 00  |.....<.u........|
000001b0  00 00 00 00 00 00 00 00  36 87 40 47 00 00 80 04  |........6.@G....|
000001c0  01 04 83 fe c2 ff 00 08  00 00 00 00 20 00 00 fe  |............ ...|
000001d0  c2 ff 83 fe c2 ff 00 08  20 00 00 00 80 0c 00 fe  |........ .......|
000001e0  c2 ff 83 fe c2 ff 00 08  a0 0c 00 00 40 06 00 fe  |............@...|
000001f0  c2 ff 05 fe c2 ff 00 08  e0 12 00 f8 1f 06 55 aa  |..............U.|
00000200

[root@centos8 /data]$echo {a..z} | cut -d" " -f1,2,3 | hexdump -C
00000000  61 20 62 20 63 0a                                 |a b c.|
00000006

[root@centos8 /data]$hexdump -C -n 12 /dev/nvme0n1      # -n 12 只显示前12字节
00000000  eb 63 90 10 8e d0 bc 00  b0 b8 00 00              |.c..........|
0000000c

[root@centos8 /data]$hexdump -C -s 2 -n 10 /dev/nvme0n1  # -s 2 -n 跳过前2字节显示后10字节
00000002  90 10 8e d0 bc 00 b0 b8  00 00                    |..........|
0000000c
```

### od

- 默认将文本内容以8进制传给标准输出，使用选项可规定其他格式；当不指明文件或者文件名为一杠'-'时，读取标准输入。

- 用法

```bash
    od [OPTION]... [FILE]...
    od [-abcdfilosx]... [FILE] [[+]OFFSET[.][b]]
    od --traditional [OPTION]... [FILE] [[+]OFFSET[.][b] [+][LABEL][.][b]]
```

- od -A x -t x1z -v /file # 以hexdump命令格式输出文件内容

```bash
[root@centos8 /data]$ od -A x -t x1z -v two_passwd
000000 72 6f 6f 74 3a 78 3a 30 3a 30 3a 72 6f 6f 74 3a  >root:x:0:0:root:<
000010 2f 72 6f 6f 74 3a 2f 62 69 6e 2f 62 61 73 68 0a  >/root:/bin/bash.<
000020 62 69 6e 3a 78 3a 31 3a 31 3a 62 69 6e 3a 2f 62  >bin:x:1:1:bin:/b<
000030 69 6e 3a 2f 73 62 69 6e 2f 6e 6f 6c 6f 67 69 6e  >in:/sbin/nologin<
000040 0a                                               >.<
000041

[root@centos8 /data]$ echo {a..z} | tr -d ' '|od -A x -t x1z
000000 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70  >abcdefghijklmnop<
000010 71 72 73 74 75 76 77 78 79 7a 0a                 >qrstuvwxyz.<
00001b
```

## xxd

- xxd命令和hexdump类似，但是其可以使用-r选项反向转换一个标准的16进制ascii码的文件，还原成人类易读的内容。

- 用法

```bash
xxd -h[elp]
xxd [options] [infile [outfile]]
xxd -r[evert] [options] [infile [outfile]]

详细使用man一下
```

```bash
[root@centos8 /data]$ echo {a..z} | tr -d ' '|od -A x -t x1z > hex_abc

[root@centos8 /data]$ cat hex_abc
000000 61 62 63 64 65 66 67 68 69 6a 6b 6c 6d 6e 6f 70  >abcdefghijklmnop<
000010 71 72 73 74 75 76 77 78 79 7a 0a                 >qrstuvwxyz.<
00001b

[root@centos8 /data]$ xxd -r hex_abc
abcdefghijklmnopqrstuvwxyz
```

- xxd和hexdump默认显示的区别

```bash
[root@centos8 /data]$ xxd two_passwd 
00000000: 726f 6f74 3a78 3a30 3a30 3a72 6f6f 743a  root:x:0:0:root:
00000010: 2f72 6f6f 743a 2f62 696e 2f62 6173 680a  /root:/bin/bash.
00000020: 6269 6e3a 783a 313a 313a 6269 6e3a 2f62  bin:x:1:1:bin:/b
00000030: 696e 3a2f 7362 696e 2f6e 6f6c 6f67 696e  in:/sbin/nologin
00000040: 0a                                       .
[root@centos8 /data]$ hexdump two_passwd
0000000 6f72 746f 783a 303a 303a 723a 6f6f 3a74
0000010 722f 6f6f 3a74 622f 6e69 622f 7361 0a68
0000020 6962 3a6e 3a78 3a31 3a31 6962 3a6e 622f
0000030 6e69 2f3a 6273 6e69 6e2f 6c6f 676f 6e69
0000040 000a
0000041
```

## 3.按行截取文件的工具

### head

- 使用head输出文件内容的前面部分，默认打印前10行；当不指明文件或者文件名为一杠'-'时，读取标准输入。
- 用法

```bash
head [OPTION]... [FILE]...
    -v # 在第一行打印文件名，使用管道传内容给head时文件名显示为：standard input
    -c bytes # 指定显示文件内容前bytes字节内容
    -n lines # 指定显示文件内容前lines行
```

### tail

- 使用tail输出文件内容的后面部分，默认打印后10行；当不指明文件或者文件名为一杠'-'时，读取标准输入。
- 用法

```bash
tail [OPTION]... [FILE]...
    -f, --follow[={name|descriptor}]  # 动态跟踪文件新增的内容
    -c bytes            # 获取文件后bytes字节内容
    -n lines            # 获取文件后lines行
    -F                  # 跟踪文件名，相当于--follow=name --retry
```

- tailf命令：类似tail –f，当文件不增长时并不访问文件，更节省系统资源
  
## 4.按列抽取文本的工具

### cut

- 使用cut命令来抽取某文件内容的某一列
- 用法

```bash
cut [OPTION]... [FILE]...
    -d DELIMITER: 指明分隔符，默认tab
    -f FILEDS:
     #: 第#个字段
     #,#[,#]：离散的多个字段，例如1,3,6
     #-#：连续的多个字段, 例如1-6
                混合使用：1-3,7
    -c 按字符切割
    --output-delimiter=STRING指定输出分隔符 
```


## 5.排序和统计文本内容

### sort

### wc

## 6.按关键字搜索抽取文本内容

### grep

## 7.比较文件和恢复文件

### diff

### patch

# 二.Linux文本处理三剑客之一:grep

# 三.基本正则表达式

# 四.扩展正则表达式
