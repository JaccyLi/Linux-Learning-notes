![](png/2020-01-19-17-08-03.png)

- Nginx+MySQL：172.20.0.105
- Nginx+MySQL：172.20.0.106
  ![](png/2020-01-19-17-11-43.png)

- 创建数据库，授权

- Nginx 和 PHP 安装
  ![](png/2020-01-19-17-19-09.png)

![](png/2020-01-19-17-20-09.png)

默认编译参数即可
![](png/2020-01-19-17-25-16.png)
![](png/2020-01-19-17-21-54.png)
![](png/2020-01-19-17-23-24.png)
新建，修改启动用户

PHP
![](png/2020-01-19-17-26-33.png)
![](png/2020-01-19-17-27-16.png)
注意 PHP 的用户 ID 要一样，用于访问 NFS
![](png/2020-01-19-17-39-26.png)
![](png/2020-01-19-17-39-35.png)
![](png/2020-01-19-17-39-53.png)

启动后 php9000port
![](png/2020-01-19-17-41-14.png)

测试页面
![](png/2020-01-19-17-42-39.png)

- ipvsadm+keepalived
  ![](png/2020-01-19-17-28-51.png)

- HAProxy
  ![](png/2020-01-19-17-29-13.png)

- nfs-server
  ![](png/2020-01-19-17-30-14.png)
  ![](png/2020-01-19-17-55-37.png)

- wordpress 配置
  ![](png/2020-01-19-17-43-53.png)
  随机字符替换
  ![](png/2020-01-19-17-47-40.png)

- Haproxy 访问 mysql

![](png/2020-01-19-17-45-47.png)
![](png/2020-01-19-18-00-06.png)
![](png/2020-01-19-18-00-23.png)
![](png/2020-01-19-18-13-40.png)
![](png/2020-01-19-18-19-32.png)


测试
![](png/2020-01-19-17-46-56.png)

- wordpress 测试
  ![](png/2020-01-19-17-48-49.png)
  ![](png/2020-01-19-17-52-16.png)
- wordpress 直接拷贝到第二 web 主机
  ![](png/2020-01-19-17-50-50.png)

- nfs
  ![](png/2020-01-19-17-53-56.png)
  ![](png/2020-01-19-17-54-06.png)
  ![](png/2020-01-19-17-57-48.png)
  ![](png/2020-01-19-17-57-23.png)
  ![](png/2020-01-19-17-57-27.png)

- Keepalived

![](png/2020-01-19-18-01-47.png)
![](png/2020-01-19-18-02-34.png)
![](png/2020-01-19-18-02-54.png)
![](png/2020-01-19-18-03-09.png)
![](png/2020-01-19-18-03-29.png)
![](png/2020-01-19-18-03-56.png)

- LVS
  lvs-dr.sh --- 在 HAProxy 上执行

  ![](png/2020-01-19-18-06-23.png)
  ![](png/2020-01-19-18-11-24.png)

  可以先指向 web 服务器测试一下是否通
  ![](png/2020-01-19-18-09-31.png)
